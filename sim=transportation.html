<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Sci-Guru • Topic 5: Transport Systems</title>
  <link rel="icon" href="lec-logo.jpg"/>
  <style>
    :root{
      --bg1:#0b1220; --bg2:#081a3b;
      --stroke:rgba(255,255,255,.12);
      --text:#eaf2ff;
      --muted:rgba(234,242,255,.72);
      --blue:#2f7bff;
      --purple:#7c5cff;
      --good:#33d07a;
      --warn:#ffcc66;
      --bad:#ff5a6b;
      --card:rgba(255,255,255,.06);
    }
    *{box-sizing:border-box}
    body{
      margin:0;color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(1200px 650px at 20% 10%, rgba(47,123,255,.34), transparent 60%),
        radial-gradient(900px 520px at 90% 30%, rgba(124,92,255,.22), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    .wrap{max-width:1200px;margin:0 auto;padding:14px 14px 36px}
    header{
      position:sticky;top:10px;z-index:10;
      display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;
      padding:12px 14px;border:1px solid var(--stroke);
      background:rgba(0,0,0,.25);backdrop-filter:blur(10px);
      border-radius:16px;
    }
    .brand{display:flex;align-items:center;gap:10px;min-width:0}
    .logo{width:44px;height:44px;border-radius:12px;overflow:hidden;border:1px solid var(--stroke);background:rgba(255,255,255,.06);display:flex;align-items:center;justify-content:center}
    .logo img{width:100%;height:100%;object-fit:cover}
    .t b{display:block;font-size:16px}
    .t span{display:block;font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    nav{display:flex;gap:8px;flex-wrap:wrap}
    .btn{
      border:1px solid var(--stroke);background:rgba(255,255,255,.06);
      color:var(--text);padding:10px 12px;border-radius:12px;text-decoration:none;
      font-weight:900;font-size:13px;cursor:pointer;
    }
    .btn.primary{border-color:rgba(47,123,255,.55);background:linear-gradient(135deg, rgba(47,123,255,.95), rgba(124,92,255,.55));color:#071022}
    .hero{
      margin-top:12px;border:1px solid var(--stroke);background:rgba(255,255,255,.05);
      border-radius:18px;padding:14px;display:flex;gap:12px;flex-wrap:wrap;justify-content:space-between;align-items:center;
    }
    .hero h1{margin:0;font-size:18px}
    .hero p{margin:6px 0 0;color:var(--muted);font-size:13px;line-height:1.5;max-width:900px}
    .pill{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--stroke);background:rgba(255,255,255,.06);padding:8px 10px;border-radius:999px;font-size:12px;color:var(--muted)}
    .dot{width:9px;height:9px;border-radius:99px;background:var(--good);box-shadow:0 0 0 4px rgba(51,208,122,.14)}
    .grid{margin-top:12px;display:grid;grid-template-columns:1.15fr .85fr;gap:12px;align-items:start}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
    .panel{border:1px solid var(--stroke);background:rgba(255,255,255,.05);border-radius:18px;overflow:hidden}
    .panelHead{padding:14px;border-bottom:1px solid var(--stroke);display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;background:rgba(0,0,0,.18)}
    .panelHead h2{margin:0;font-size:14px}
    .panelHead small{color:var(--muted)}
    .panelBody{padding:12px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{padding:10px 12px;border-radius:999px;border:1px solid var(--stroke);background:rgba(255,255,255,.06);color:var(--muted);font-weight:900;font-size:12px;cursor:pointer}
    .tab.active{color:#071022;border-color:rgba(47,123,255,.55);background:linear-gradient(135deg, rgba(47,123,255,.95), rgba(124,92,255,.55))}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:740px){.two{grid-template-columns:1fr}}
    .card{border:1px solid var(--stroke);background:rgba(255,255,255,.05);border-radius:16px;padding:12px}
    .card h3{margin:0 0 8px;font-size:13px}
    .card p{margin:0;color:var(--muted);font-size:12px;line-height:1.5}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .miniBtn{border:1px solid var(--stroke);background:rgba(255,255,255,.06);color:var(--text);padding:9px 10px;border-radius:12px;font-weight:900;font-size:12px;cursor:pointer}
    .miniBtn.primary{border-color:rgba(47,123,255,.55);background:linear-gradient(135deg, rgba(47,123,255,.95), rgba(124,92,255,.55));color:#071022}
    .feedback{margin-top:10px;border:1px solid var(--stroke);background:rgba(0,0,0,.18);border-radius:16px;padding:12px;min-height:80px;white-space:pre-wrap}
    .simBox{border:1px solid var(--stroke);background:rgba(255,255,255,.05);border-radius:16px;padding:12px}
    .simBox h4{margin:0 0 8px;font-size:13px}
    .bar{height:12px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);overflow:hidden}
    .fill{height:100%;width:0%;background:linear-gradient(135deg, rgba(47,123,255,.95), rgba(124,92,255,.55))}
    select{width:100%;max-width:340px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:var(--text);border-radius:14px;padding:12px;outline:none;font-size:14px}
    .quizList{display:grid;gap:10px;margin-top:10px}
    .qItem{border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);border-radius:14px;padding:10px;display:flex;justify-content:space-between;gap:10px;align-items:center}
    .qItem b{display:block;font-size:13px}
    .qItem small{display:block;margin-top:4px;color:var(--muted);font-size:12px;line-height:1.4}
    footer{margin-top:16px;text-align:center;color:rgba(234,242,255,.62);font-size:12px}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand">
      <div class="logo"><img src="lec-logo.jpg" alt="Logo" onerror="this.style.display='none';this.parentElement.textContent='SG';"></div>
      <div class="t">
        <b>Topic 5 • Transport Systems (Virtual Lab)</b>
        <span>Diffusion • Osmosis • Blood components</span>
      </div>
    </div>
    <nav>
      <a class="btn" href="tutor.html">← Back to Tutor</a>
      <a class="btn" href="labs-hub.html">Labs Hub</a>
      <a class="btn primary" href="sim-transport.html">Refresh</a>
    </nav>
  </header>

  <section class="hero">
    <div>
      <h1>Transport in Plants & Animals</h1>
      <p>Run 3 activities: <b>Diffusion demo</b>, <b>Osmosis potato strip</b>, and <b>Blood components</b> + a quiz.</p>
    </div>
    <div class="pill"><span class="dot"></span> Auto-save enabled</div>
  </section>

  <div class="grid">
    <section class="panel">
      <div class="panelHead">
        <div><h2>Activities</h2><small>Use tabs to switch</small></div>
        <div class="tabs" id="tabs"></div>
      </div>
      <div class="panelBody">

        <div class="view" id="view-diff">
          <div class="two">
            <div class="card">
              <h3>Diffusion</h3>
              <p>Diffusion is the movement of particles from a region of <b>high</b> concentration to <b>low</b> concentration.</p>
            </div>
            <div class="card">
              <h3>Try it</h3>
              <p>Drop “dye crystals” into water and watch it spread. Faster when warm + stirred.</p>
            </div>
          </div>

          <div class="simBox" style="margin-top:10px">
            <h4>Diffusion Simulator</h4>
            <div class="two">
              <div>
                <div class="bar"><div class="fill" id="diffFill"></div></div>
                <p style="color:var(--muted);font-size:12px;margin:8px 0 0" id="diffText">Spread: 0%</p>
              </div>
              <div>
                <label style="color:var(--muted);font-size:12px">Conditions</label>
                <select id="diffMode">
                  <option value="slow">Cold water (slow)</option>
                  <option value="normal" selected>Room temperature (normal)</option>
                  <option value="fast">Warm + stirring (fast)</option>
                </select>
              </div>
            </div>

            <div class="controls">
              <button class="miniBtn primary" id="diffStart">Drop Dye</button>
              <button class="miniBtn" id="diffReset">Reset</button>
            </div>

            <div class="feedback" id="diffFeedback">Click <b>Drop Dye</b> to start diffusion.</div>
          </div>
        </div>

        <div class="view" id="view-osmo" style="display:none">
          <div class="two">
            <div class="card">
              <h3>Osmosis</h3>
              <p>Osmosis is the movement of <b>water</b> through a partially permeable membrane from high water concentration to low.</p>
            </div>
            <div class="card">
              <h3>Try it</h3>
              <p>Place a potato strip in different solutions and observe mass change.</p>
            </div>
          </div>

          <div class="simBox" style="margin-top:10px">
            <h4>Potato Strip Osmosis</h4>
            <div class="two">
              <div>
                <label style="color:var(--muted);font-size:12px">Solution</label>
                <select id="osmoSol">
                  <option value="water">Pure water</option>
                  <option value="weak">Weak salt/sugar solution</option>
                  <option value="strong">Strong salt/sugar solution</option>
                </select>
                <p style="color:var(--muted);font-size:12px;margin:8px 0 0">Starting mass: <b>10.0 g</b></p>
                <p style="color:var(--muted);font-size:12px;margin:0" id="osmoMass">Final mass: —</p>
              </div>
              <div>
                <div class="bar"><div class="fill" id="osmoFill"></div></div>
                <p style="color:var(--muted);font-size:12px;margin:8px 0 0" id="osmoText">Water movement: —</p>
              </div>
            </div>

            <div class="controls">
              <button class="miniBtn primary" id="osmoRun">Run Experiment</button>
              <button class="miniBtn" id="osmoReset">Reset</button>
            </div>

            <div class="feedback" id="osmoFeedback">Choose a solution, then run the experiment.</div>
          </div>
        </div>

        <div class="view" id="view-blood" style="display:none">
          <div class="two">
            <div class="card">
              <h3>Blood Components</h3>
              <p>Match each component with its function.</p>
            </div>
            <div class="card">
              <h3>Hint</h3>
              <p>RBC carry oxygen (haemoglobin), WBC defend, platelets clot, plasma carries dissolved substances.</p>
            </div>
          </div>

          <div class="simBox" style="margin-top:10px">
            <h4>Match the function</h4>

            <div class="quizList" id="bloodMatch"></div>

            <div class="controls">
              <button class="miniBtn primary" id="bloodCheck">Check</button>
              <button class="miniBtn" id="bloodReset">Reset</button>
            </div>

            <div class="feedback" id="bloodFeedback">Select answers then press Check.</div>
          </div>
        </div>

        <div class="view" id="view-quiz" style="display:none">
          <div class="card">
            <h3>Topic 5 Quiz</h3>
            <p>Answer all then click <b>Mark Quiz</b>.</p>
          </div>

          <div class="quizList" id="quizList"></div>

          <div class="controls">
            <button class="miniBtn primary" id="markQuiz">Mark Quiz</button>
            <button class="miniBtn" id="resetQuiz">Reset</button>
          </div>

          <div class="feedback" id="quizFeedback">Start answering the quiz.</div>
        </div>

      </div>
    </section>

    <aside class="panel">
      <div class="panelHead"><div><h2>Progress</h2><small>Saved in your browser</small></div></div>
      <div class="panelBody">
        <div class="card">
          <h3>Total Score</h3>
          <p style="font-size:28px;font-weight:900;margin:6px 0 0" id="score">0</p>
          <p class="pill" id="badge" style="margin-top:8px;">Badge: Starter</p>
        </div>
        <div style="height:10px"></div>
        <div class="card">
          <h3>Key definitions</h3>
          <p>
            • Diffusion: high → low concentration<br/>
            • Osmosis: water across membrane<br/>
            • Plasma: liquid part<br/>
            • RBC: oxygen transport<br/>
            • WBC: defense<br/>
            • Platelets: clotting
          </p>
        </div>
      </div>
    </aside>
  </div>

  <footer>© 2025 LEC Biotec • sales@lecbiotec.com • Harare, Zimbabwe</footer>
</div>

<script>
  const KEY="sciguru_topic5_transport_v1";
  const state = load() || {
    score:0,_awards:{},
    tab:"diff",
    diff:{started:false,progress:0},
    osmo:{done:false,solution:"water",mass:null,moveText:"—",fill:0},
    blood:{ans:{}},
    quiz:{}
  };
  function load(){try{return JSON.parse(localStorage.getItem(KEY))}catch(e){return null}}
  function save(){localStorage.setItem(KEY, JSON.stringify(state)); renderScore();}

  // tabs
  const TABS=[
    {id:"diff", label:"1) Diffusion"},
    {id:"osmo", label:"2) Osmosis"},
    {id:"blood", label:"3) Blood"},
    {id:"quiz", label:"4) Quiz"}
  ];
  let active = state.tab || "diff";
  const tabsEl=document.getElementById("tabs");
  function renderTabs(){
    tabsEl.innerHTML="";
    TABS.forEach(t=>{
      const b=document.createElement("button");
      b.className="tab"+(t.id===active?" active":"");
      b.type="button"; b.textContent=t.label;
      b.onclick=()=>{active=t.id; state.tab=active; showView(); renderTabs(); save();};
      tabsEl.appendChild(b);
    });
  }
  function showView(){
    document.getElementById("view-diff").style.display = active==="diff"?"":"none";
    document.getElementById("view-osmo").style.display = active==="osmo"?"":"none";
    document.getElementById("view-blood").style.display = active==="blood"?"":"none";
    document.getElementById("view-quiz").style.display = active==="quiz"?"":"none";
  }

  // score helpers
  function addScore(points,key){
    state._awards = state._awards || {};
    if(state._awards[key]) return;
    state._awards[key]=true;
    state.score += points;
  }
  function badgeFromScore(s){ if(s>=80) return "Transport Pro"; if(s>=55) return "Explorer"; if(s>=30) return "Improving"; return "Starter"; }
  function renderScore(){
    document.getElementById("score").textContent = state.score||0;
    document.getElementById("badge").textContent = "Badge: " + badgeFromScore(state.score||0);
  }

  // Diffusion
  const diffFill=document.getElementById("diffFill");
  const diffText=document.getElementById("diffText");
  const diffFeedback=document.getElementById("diffFeedback");
  const diffMode=document.getElementById("diffMode");
  let diffTimer=null;

  function setDiffUI(p){
    diffFill.style.width = p+"%";
    diffText.textContent = "Spread: "+p+"%";
  }
  document.getElementById("diffStart").onclick=()=>{
    if(diffTimer) return;
    state.diff.started=true;
    state.diff.progress=0;
    setDiffUI(0);
    diffFeedback.textContent="Diffusion started… particles move from high → low concentration.";
    const mode=diffMode.value;
    const step = mode==="slow"? 2 : mode==="fast"? 6 : 4;
    diffTimer=setInterval(()=>{
      state.diff.progress=Math.min(100, state.diff.progress+step);
      setDiffUI(state.diff.progress);
      if(state.diff.progress>=100){
        clearInterval(diffTimer); diffTimer=null;
        diffFeedback.textContent="✅ Complete: dye evenly spread (dynamic equilibrium).";
        addScore(15,"diffDone");
        save();
      }
    }, 250);
    save();
  };
  document.getElementById("diffReset").onclick=()=>{
    if(diffTimer){clearInterval(diffTimer); diffTimer=null;}
    state.diff={started:false,progress:0};
    setDiffUI(0);
    diffFeedback.textContent="Reset complete. Click Drop Dye to start diffusion.";
    save();
  };

  // Osmosis
  const osmoSol=document.getElementById("osmoSol");
  const osmoMass=document.getElementById("osmoMass");
  const osmoFill=document.getElementById("osmoFill");
  const osmoText=document.getElementById("osmoText");
  const osmoFeedback=document.getElementById("osmoFeedback");

  osmoSol.value = state.osmo.solution || "water";
  function osmoUI(){
    osmoMass.textContent = "Final mass: " + (state.osmo.mass==null? "—" : state.osmo.mass.toFixed(1)+" g");
    osmoFill.style.width = (state.osmo.fill||0)+"%";
    osmoText.textContent = "Water movement: " + (state.osmo.moveText||"—");
  }
  osmoUI();

  osmoSol.onchange=()=>{state.osmo.solution=osmoSol.value; save();};

  document.getElementById("osmoRun").onclick=()=>{
    const sol=osmoSol.value;
    let mass=10.0, move="—", fill=50;
    if(sol==="water"){ mass=12.0; move="Into potato (turgid) ✅"; fill=85; addScore(15,"osmoWater"); }
    if(sol==="weak"){ mass=10.5; move="Small net movement"; fill=60; addScore(10,"osmoWeak"); }
    if(sol==="strong"){ mass=8.5; move="Out of potato (flaccid) ❌"; fill=25; addScore(15,"osmoStrong"); }
    state.osmo.done=true; state.osmo.mass=mass; state.osmo.moveText=move; state.osmo.fill=fill;
    osmoFeedback.textContent = "Result recorded. Explain: water moves from high water concentration to low through membranes.";
    osmoUI(); save();
  };
  document.getElementById("osmoReset").onclick=()=>{
    state.osmo={done:false,solution:osmoSol.value,mass:null,moveText:"—",fill:0};
    osmoFeedback.textContent="Reset complete. Choose a solution and run again.";
    osmoUI(); save();
  };

  // Blood match
  const bloodItems=[
    {id:"plasma", name:"Plasma", correct:"Dissolves and transports substances (food, hormones, CO₂)."},
    {id:"rbc", name:"Red blood cells", correct:"Carry oxygen using haemoglobin."},
    {id:"wbc", name:"White blood cells", correct:"Defend the body against pathogens."},
    {id:"platelets", name:"Platelets", correct:"Help blood clot to stop bleeding."}
  ];
  const bloodOpts=[
    "Carry oxygen using haemoglobin.",
    "Defend the body against pathogens.",
    "Help blood clot to stop bleeding.",
    "Dissolves and transports substances (food, hormones, CO₂)."
  ];
  const bloodMatch=document.getElementById("bloodMatch");
  const bloodFeedback=document.getElementById("bloodFeedback");

  function renderBlood(){
    bloodMatch.innerHTML="";
    bloodItems.forEach((x,i)=>{
      const val = state.blood.ans[x.id];
      const row=document.createElement("div");
      row.className="qItem";
      row.innerHTML=`
        <div style="min-width:0">
          <b>${i+1}. ${x.name}</b>
          <small>Choose the correct function</small>
        </div>
        <div>
          <select data-b="${x.id}">
            <option value="" ${val==null?"selected":""}>-- choose --</option>
            ${bloodOpts.map((o)=>`<option value="${o}" ${val===o?"selected":""}>${o}</option>`).join("")}
          </select>
        </div>
      `;
      bloodMatch.appendChild(row);
    });
    bloodMatch.querySelectorAll("select[data-b]").forEach(s=>{
      s.onchange=()=>{state.blood.ans[s.dataset.b]=s.value||null; save();};
    });
  }
  renderBlood();

  document.getElementById("bloodCheck").onclick=()=>{
    let answered=0, correct=0;
    bloodItems.forEach(x=>{
      const a=state.blood.ans[x.id];
      if(!a) return;
      answered++;
      if(a===x.correct) correct++;
    });
    if(answered < bloodItems.length){
      bloodFeedback.textContent = `Answered ${answered}/${bloodItems.length}. Finish all to score.`;
      return;
    }
    const pts = Math.round((correct/bloodItems.length)*20);
    addScore(pts,"bloodDone");
    bloodFeedback.textContent = `✅ Match Results: ${correct}/${bloodItems.length}\nPoints added: ${pts}/20`;
    save();
  };
  document.getElementById("bloodReset").onclick=()=>{
    state.blood.ans={};
    bloodFeedback.textContent="Reset complete. Match again.";
    renderBlood(); save();
  };

  // Quiz
  const QUIZ=[
    {id:"q1", q:"Diffusion is movement from ____ concentration to ____ concentration.", opts:["low→high","high→low","equal→high"], correct:1, exp:"Diffusion: high to low concentration."},
    {id:"q2", q:"Osmosis is the movement of ____ through a partially permeable membrane.", opts:["salt","water","proteins"], correct:1, exp:"Osmosis is movement of water."},
    {id:"q3", q:"Which carries oxygen?", opts:["Plasma","White blood cells","Red blood cells"], correct:2, exp:"Red blood cells carry oxygen using haemoglobin."},
    {id:"q4", q:"Which helps blood clot?", opts:["Platelets","Plasma","Red blood cells"], correct:0, exp:"Platelets help clotting."},
    {id:"q5", q:"White blood cells mainly ____.", opts:["defend against pathogens","carry oxygen","store fat"], correct:0, exp:"WBC defend the body."}
  ];
  const quizList=document.getElementById("quizList");
  const quizFeedback=document.getElementById("quizFeedback");

  function renderQuiz(){
    quizList.innerHTML="";
    QUIZ.forEach((x,i)=>{
      const val=state.quiz[x.id];
      const row=document.createElement("div");
      row.className="qItem";
      row.innerHTML=`
        <div style="min-width:0">
          <b>${i+1}. ${x.q}</b><small>Select one answer</small>
        </div>
        <div>
          <select data-q="${x.id}">
            <option value="" ${val==null?"selected":""}>-- choose --</option>
            ${x.opts.map((o,idx)=>`<option value="${idx}" ${String(val)===String(idx)?"selected":""}>${o}</option>`).join("")}
          </select>
        </div>
      `;
      quizList.appendChild(row);
    });
    quizList.querySelectorAll("select[data-q]").forEach(s=>{
      s.onchange=()=>{state.quiz[s.dataset.q]=s.value===""?null:Number(s.value); save();};
    });
  }
  renderQuiz();

  document.getElementById("markQuiz").onclick=()=>{
    let answered=0, correct=0;
    QUIZ.forEach(x=>{
      const a=state.quiz[x.id];
      if(a==null) return;
      answered++;
      if(a===x.correct) correct++;
    });
    if(answered < QUIZ.length){
      quizFeedback.textContent = `Answered ${answered}/${QUIZ.length}. Finish all then mark.`;
      return;
    }
    const pts=Math.round((correct/QUIZ.length)*30);
    addScore(pts,"topic5Quiz");
    let msg=`Quiz Results:\nCorrect: ${correct}/${QUIZ.length}\nPoints added: ${pts}/30\n\n`;
    QUIZ.forEach((x,i)=>{
      const ok=state.quiz[x.id]===x.correct;
      msg += `${i+1}) ${ok?"✅":"❌"} ${x.exp}\n`;
    });
    quizFeedback.textContent=msg;
    save();
  };
  document.getElementById("resetQuiz").onclick=()=>{
    state.quiz={};
    quizFeedback.textContent="Quiz reset.";
    renderQuiz(); save();
  };

  // init
  function init(){
    renderTabs(); showView(); renderScore();
    setDiffUI(state.diff.progress||0);
    osmoUI();
    save();
  }
  init();
</script>
</body>
</html>